<!DOCTYPE html>
<html>

<head>
    <title></title>

    <h1>í”¼ì¹´ì¶©ì „ì†Œ ê²Œì„</h1>
    <p>ê²Œì„í•˜ê³  ë¬´ë£Œë¡œ ì „ê¸°ì°¨ ì¶©ì „í•˜ê¸°âš¡</p>
    <p>ì¥ì• ë¬¼ì„ í”¼í•´ ì „ê¸°ì°¨ ì£¼ìœ ì†Œê¹Œì§€ ë„ë‹¬í•˜ë©´ ë„í† ë¦¬ğŸŒ° 1ê°œë¥¼ ë“œë¦½ë‹ˆë‹¤.<br>
        ë„í† ë¦¬ 10ê°œëŠ” ì „ê¸°ì°¨ ë¬´ë£Œ ì¶©ì „ 1íšŒ ì¿ í°ê³¼ ë°”ê¿€ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
    <p>ê²Œì„ ë°©ë²• : ìŠ¤í˜ì´ìŠ¤ë°”ë¥¼ ëˆŒëŸ¬ ë‹¤ê°€ì˜¤ëŠ” ì¥ì• ë¬¼ì„ ì í”„ë¡œ í”¼í•˜ì„¸ìš”.<br>
        ì£¼ìœ ì†Œê¹Œì§€ ë„ë‹¬í•˜ë©´ ë„í† ë¦¬ 1ê°œë¥¼ ë°›ì„ ìˆ˜ ìˆì–´ìš”.ğŸ¿ï¸</div>
    </p>

</head>

<body onload="loaded()" onkeydown="keydown()" onkeyup="keyup()">
    <canvas width="1100" height="587" style="border: 2px solid black;" id="c1"></canvas>



    <script>

        var canvas; //ë„í™”ì§€ ê°ì²´
        var context; //í™”ê°€ ê°ì²´

        // í”Œë ˆì´ì–´ ì´ë™ ë°©í–¥ê³¼ ì†ë„
        var dx = 0;
        var dy = 0;

        // í‚¤ ì´ë²¤íŠ¸ë¡œ ì¸í•´ ì¸ì‹ëœ keycodeë³€ìˆ˜
        var keycode;

        // ì „ì—­ë³€ìˆ˜ë¡œì„œ ì´ë¯¸ì§€ ê°ì²´ ìƒì„±
        var imgCharRight = new Image();
        imgCharRight.src = "/gamecar_right.png";

        var imgCharLeft = new Image();
        imgCharLeft.src = "/gamecar_left.png";

        var bgImages = [];
        for (var i = 1; i <= 9; i++) {
            bgImages[i] = new Image();
            bgImages[i].src = "/map" + i + ".png";
        }
        var currentBgIndex = 1;
        var imgBg = bgImages[currentBgIndex];

        // í”Œë ˆì´ì–´ ìºë¦­í„°ì˜ ì¤‘ì‹¬ì¢Œí‘œ
        var x = 800, y = 425; //ì • ê°€ìš´ë°ë¡œ ìœ„ì¹˜
        var w = 40, h = 40; //í”Œë ˆì´ì–´ ì´ë¯¸ì§€ì˜ ì ˆë°˜ ì‚¬ì´ì¦ˆ

        function loaded() {
            canvas = document.getElementById('c1');
            context = canvas.getContext('2d');

            // í”Œë ˆì´ì–´ ì´ˆê¸° ìœ„ì¹˜ë¥¼ ìº”ë²„ìŠ¤ ì¤‘ì•™ìœ¼ë¡œ ì„¤ì •
            var playerWidth = 200; // ìºë¦­í„° ì´ë¯¸ì§€ì˜ ê°€ë¡œ í¬ê¸°
            var playerHeight = 112; // ìºë¦­í„° ì´ë¯¸ì§€ì˜ ì„¸ë¡œ í¬ê¸°
            var centerX = canvas.width / 2;
            var centerY = canvas.height / 2;

            // í”Œë ˆì´ì–´ ì´ˆê¸° ìœ„ì¹˜ ì„¤ì •
            x = centerX;
            y = centerY;


            runGame(); //ê²Œì„ì„ ì§„í–‰í•˜ëŠ” í•¨ìˆ˜
            //10ms ë§ˆë‹¤ runGame()ë¥¼ ë‹¤ì‹œ í˜¸ì¶œ
            setInterval(runGame, 10); //1ì´ˆì— 100ë²ˆ í˜¸ì¶œ 
        }

        function runGame() {
            moveAll(); //ìºë¦­í„° ì›€ì§ì´ê¸°
            drawAll(); // ì´ë¯¸ì§€ë“¤ ê·¸ë¦¬ê¸°
        }

        var targetX = Math.floor(Math.random() * 1000); // ëª©í‘œ ì§€ì ì˜ x ì¢Œí‘œ
        var targetY = Math.floor(Math.random() * 500); // ëª©í‘œ ì§€ì ì˜ y ì¢Œí‘œ

        function moveAll() {
            x += dx;
            y += dy;

            if (x > canvas.width) {
                x = 0;
                changeBackground();
            } else if (x < 0) {
                x = canvas.width;
                changeBackground();
            }

            if (y > canvas.height) {
                y = 0;
                changeBackground();
            } else if (y < 0) {
                y = canvas.height;
                changeBackground();
            }
            checkTargetReached();
        }

        var imgTarget = new Image();
        imgTarget.src = "/charger.png";
        imgTarget.onload = function () {
            targetReady = true;
        };


        function checkTargetReached() {
            context.drawImage(imgTarget, targetX, targetY); // ëª©í‘œ ì§€ì ì— ì´ë¯¸ì§€ ê·¸ë¦¬ê¸°

            if (Math.abs(x - targetX) <= w && Math.abs(y - targetY) <= h) {
                window.location.href = '/media/game';   // í˜„ì¬ í˜ì´ì§€ì—ì„œ /media/gameìœ¼ë¡œ ì´ë™.
            }
        }

        function changeBackground() {
            currentBgIndex++;
            if (currentBgIndex > bgImages.length - 1) {
                currentBgIndex = 1;
            }
            imgBg = bgImages[currentBgIndex];
        }


        function drawAll() {
            //ë°°ê²½ ê·¸ë¦¬ê¸°
            context.drawImage(imgBg, 0, 0, 1600, 850);

            if (targetReady) {
                context.drawImage(imgTarget, targetX, targetY, w * 3, h * 3);
                // ìœ„ì—ì„œ wì™€ hëŠ” í”Œë ˆì´ì–´ ìºë¦­í„°ì˜ ì ˆë°˜ ì‚¬ì´ì¦ˆì…ë‹ˆë‹¤.
                // ì´ ê°’ì„ ë‘ ë°°ë¡œ ì„¤ì •í•˜ì—¬ ëª©í‘œ ì§€ì  ì´ë¯¸ì§€ì˜ ê°€ë¡œ ì„¸ë¡œ ê¸¸ì´ë¥¼ ì„¤ì •í–ˆìŠµë‹ˆë‹¤.
            }

            let playerImage = imgCharRight;
            if (dx > 0) playerImage = imgCharRight;
            else if (dx < 0) playerImage = imgCharLeft;
            else if (dy < 0) playerImage = imgCharLeft;

            //í”Œë ˆì´ì–´ ê·¸ë¦¬ê¸°
            context.drawImage(playerImage, x - w / 2, y - h / 2, w * 3.5, h * 3);


            // í‚¤ ì½”ë“œê°’ ê¸€ì”¨ ê·¸ë¦¬ê¸°
            context.fillStyle = "white";
            context.font = "30px sans-serif";
            context.fillText(keycode, 10, 40);
        }

        function keydown() {
            //ëˆŒëŸ¬ì§„ keyì˜ ì½”ë“œê°’
            keycode = event.keyCode;
            switch (keycode) {
                case 37: dx = -2.5; event.preventDefault(); break; //left
                case 38: dy = -2.5; event.preventDefault(); break; //up
                case 39: dx = 2.5; event.preventDefault(); break; //right
                case 40: dy = 2.5; event.preventDefault(); break; //down
            }
        }
        function keyup() {
            //ë–¨ì–´ì§„ keyì˜ ì½”ë“œê°’
            keycode = event.keyCode;
            switch (keycode) {
                case 37:
                case 39: dx = 0; event.preventDefault(); break;
                case 38:
                case 40: dy = 0; event.preventDefault(); break;
            }
        }

        // // ì‚¬ìš´ë“œ ì‘ì—… : í¬ë¡¬ì€ ìë™ ì¬ìƒì„ ë§‰ì€ ë“¯ í•¨. EdgeëŠ” ë  ê²ƒì„
        // var sd = new Audio('./dragon_flight.mp3');
        // sd.volume = 1.0; //0.0 ~ 1.0
        // sd.loof = true; //ë°˜ë³µì¬ìƒì—¬ë¶€
        // sd.play();

    </script>


</body>

</html>